(function(a){this.LazyLoad=new Class({Implements:[Options,Events],options:{range:200,image:"blank.gif",resetDimensions:true,elements:"img",container:window},initialize:function(b){this.setOptions(b);this.container=a(this.options.container);this.elements=$$(this.options.elements);this.containerHeight=this.container.getSize().y;this.start=0;this.elements=this.elements.filter(function(d){if(d.getPosition(this.container).y>this.containerHeight+this.options.range){d.store("oSRC",d.get("src")).set("src",this.options.image);if(this.options.resetDimensions){d.store("oWidth",d.get("width")).store("oHeight",d.get("height")).set({width:"",height:""});}return true;}},this);var c=function(){var d=this.container.getScroll().y;if(d>this.start){this.elements=this.elements.filter(function(e){if((this.container.getScroll().y+this.options.range+this.containerHeight)>=e.getPosition(this.container).y){if(e.retrieve("oSRC")){e.set("src",e.retrieve("oSRC"));}if(this.options.resetDimensions){e.set({width:e.retrieve("oWidth"),height:e.retrieve("oHeight")});}this.fireEvent("load",[e]);return false;}return true;},this);this.start=d;}this.fireEvent("scroll");if(!this.elements.length){this.container.removeEvent("scroll",c);this.fireEvent("complete");}}.bind(this);this.container.addEvent("scroll",c);}});})(document.id);